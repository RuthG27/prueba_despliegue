<div class="profile-container">
    <div class="profile-card">
        <div class="profile-content">
            @if (!isEditing) {
            <div class="profile-header">
                <h1 class="profile-greeting">Hola,
                    <br>
                    ¡bienvenido {{ userData?.name || 'Usuario' }}!
                </h1>
            </div>

            <div class="profile-details">
                <div class="detail-item">
                    <span class="detail-label">Usuario:</span>
                    <span class="detail-value">{{ userData?.name || 'N/A' }}</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">Correo:</span>
                    <span class="detail-value">{{ userData?.email || 'N/A' }}</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">Password:</span>
                    <span class="detail-value">************</span>
                </div>
            </div>

            @if (successMessage) {
            <div class="success-message">{{ successMessage }}</div>
            }

            @if (errorMessage) {
            <div class="error-message">{{ errorMessage }}</div>
            }

            <button class="edit-button" (click)="editUser()">
                <img src="/img/lapiz.png" alt="Editar" class="edit-icon" />
                Editar usuario
            </button>

            <button class="logout-profile-btn" (click)="logout()">
                Cerrar sesión
            </button>

            <button class="delete-account-btn" (click)="deleteAccount()">
                Eliminar cuenta
            </button>
            } @else {
            <div class="profile-header">
                <h2 class="edit-title">Editar perfil</h2>
            </div>

            <div class="profile-form">
                @if (successMessage) {
                <div class="success-message">{{ successMessage }}</div>
                }

                @if (errorMessage) {
                <div class="error-message">{{ errorMessage }}</div>
                }

                <div class="form-group">
                    <label for="name">Usuario:</label>
                    <input id="name" type="text" [(ngModel)]="editForm.name" placeholder="nombre de usuario" />
                </div>

                <div class="form-group">
                    <label for="email">Correo:</label>
                    <input id="email" type="email" [(ngModel)]="editForm.email" placeholder="correo@gmail.com" />
                </div>

                <div class="form-group">
                    <label for="password">Nueva Password:</label>
                    <input id="password" type="password" [(ngModel)]="editForm.password"
                        placeholder="nueva contraseña" />
                </div>

                <div class="edit-actions">
                    <button class="save-btn" (click)="saveProfile()">Guardar cambios</button>
                    <button class="cancel-btn" (click)="cancelEdit()">Cancelar</button>
                </div>
            </div>
            }
        </div>
    </div>
</div>
<section class="saved-recipes">
    <div class="recipes-header">
        <h2 class="recipes-title">Recetas guardadas</h2>
    </div>
    <div class="recipes-wrapper">
        <button class="nav-btn prev-btn" (click)="scrollRecipes('saved-recipes', 'left')">‹</button>
        <div class="recipes-container">
            @for (recipe of savedRecipes; track recipe._id) {
            <div class="recipe-card">
                <div class="recipe-image">
                    <img [src]="recipe.img" [alt]="recipe.nombre" />
                </div>
                <h3 class="recipe-name">{{ recipe.nombre }}</h3>
                <div class="recipe-rating">
                    @for (star of getStars(recipe.puntuacion); track $index) {
                    <span class="star" [class.filled]="star === 'full'">★</span>
                    }
                </div>
                <button class="recipe-btn">Ver receta</button>
            </div>
            }
        </div>
        <button class="nav-btn next-btn" (click)="scrollRecipes('saved-recipes', 'right')">›</button>
    </div>
</section>
<section class="published-recipes">
    <div class="recipes-header">
        <h2 class="recipes-title">Recetas publicadas</h2>
        <button class="upload-btn" (click)="navegarASubirReceta()">+ Subir nueva receta</button>
    </div>
    <div class="recipes-wrapper">
        <button class="nav-btn prev-btn" (click)="scrollRecipes('published-recipes', 'left')">‹</button>
        <div class="recipes-container">
            @for (recipe of publishedRecipes; track recipe._id) {
            <div class="recipe-card">
                <div class="recipe-image">
                    <img [src]="recipe.img" [alt]="recipe.nombre" />
                </div>
                <h3 class="recipe-name">{{ recipe.nombre }}</h3>
                <div class="recipe-rating">
                    @for (star of getStars(recipe.puntuacion); track $index) {
                    <span class="star" [class.filled]="star === 'full'">★</span>
                    }
                </div>
                <button class="recipe-btn">Editar</button>
            </div>
            }
        </div>
        <button class="nav-btn next-btn" (click)="scrollRecipes('published-recipes', 'right')">›</button>
    </div>
</section>